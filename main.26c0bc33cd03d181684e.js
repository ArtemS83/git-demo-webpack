(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{L1EO:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("L1EO"),n("8cZI"),n("lmye"),n("D/wG"),n("JBxO"),n("FdtR");var s={signupBtn:document.querySelector(".signup"),loginBtn:document.querySelector(".login"),logoutBtn:document.querySelector(".logout"),signupForm:document.querySelector(".form-signup"),loginForm:document.querySelector(".form-login"),registrationBtn:document.querySelector(".form-signup button"),textError:document.querySelector(".span-error"),userName:document.querySelector(".user-info .name"),userEmail:document.querySelector(".user-info .email"),contentForm:document.querySelector(".content"),formADD:document.querySelector(".form"),listContacs:document.querySelector(".js-list"),textNoContacts:document.querySelector(".span-no-contacts"),formUpdate:document.querySelector(".form-update")},o="https://goit-phonebook-api.herokuapp.com",r="";function i(e){e.preventDefault(),s.textError.classList.add("is-hidden");var t,n,i=e.currentTarget.elements.userName.value,a=e.currentTarget.elements.email.value,d=e.currentTarget.elements.password.value;(t={name:i,email:a,password:d},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},fetch(o+"/users/signup",n).then((function(e){return 400===e.status?void s.textError.classList.remove("is-hidden"):e.json()}))).then((function(e){r=e.token,s.userName.textContent=e.user.name,s.userEmail.textContent=e.user.email,s.signupForm.reset(),s.textError.classList.add("is-hidden"),s.signupForm.classList.add("is-hidden"),s.contentForm.classList.remove("is-hidden"),s.logoutBtn.classList.remove("is-hidden"),s.textNoContacts.classList.remove("is-hidden")})).catch((function(e){return console.log(e)}))}function a(e){e.preventDefault(),s.textError.classList.add("is-hidden");var t,n,i=e.currentTarget.elements.email.value,a=e.currentTarget.elements.password.value;(t={email:i,password:a},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},fetch(o+"/users/login",n).then((function(e){return 400===e.status?void s.textError.classList.remove("is-hidden"):e.json()}))).then((function(e){r=e.token,s.userName.textContent=e.user.name,s.userEmail.textContent=e.user.email,s.loginForm.reset(),s.textError.classList.add("is-hidden"),s.loginForm.classList.add("is-hidden"),s.contentForm.classList.remove("is-hidden"),s.logoutBtn.classList.remove("is-hidden"),d(r)})).catch((function(e){return console.log(e)}))}function d(e){(function(e){return fetch(o+"/contacts",{headers:{Authorization:"Bearer "+e}}).then((function(e){return e.json()}))})(e).then((function(e){!function(e){if(s.listContacs.innerHTML="",e.length<=0)return void s.textNoContacts.classList.remove("is-hidden");c(e)}(e)})).catch((function(e){return console.log(e)}))}function c(e){var t=e.map((function(e){var t=e.id;return'<li>\n        <span class="js-name-'+t+'">'+e.name+': </span> <span class="js-number-'+t+'">'+e.number+'</span>\n        \n          <button class="delete" data-id='+t+' data-type="delete">delete</button>\n          <button class="update" data-id='+t+' data-type="update">update</button>\n        </li>'})).join("");s.listContacs.insertAdjacentHTML("beforeend",t)}s.signupBtn.addEventListener("click",(function(){s.signupBtn.classList.add("is-hidden"),s.loginBtn.classList.add("is-hidden"),s.signupForm.classList.remove("is-hidden"),s.signupForm.addEventListener("submit",i)})),s.loginBtn.addEventListener("click",(function(){s.signupBtn.classList.add("is-hidden"),s.loginBtn.classList.add("is-hidden"),s.loginForm.classList.remove("is-hidden"),s.loginForm.addEventListener("submit",a)})),s.logoutBtn.addEventListener("click",(function(){(e=r,fetch(o+"/users/logout",{method:"POST",headers:{Authorization:"Bearer "+e}}).then((function(e){return 401===e.status?void s.textError.classList.remove("is-hidden"):e.json()}))).then((function(){r="",s.userName.textContent="",s.userEmail.textContent="",s.logoutBtn.classList.add("is-hidden"),s.textError.classList.add("is-hidden"),s.loginForm.classList.add("is-hidden"),s.contentForm.classList.add("is-hidden"),s.signupBtn.classList.remove("is-hidden"),s.loginBtn.classList.remove("is-hidden"),s.listContacs.innerHTML="",s.textNoContacts.classList.add("is-hidden")})).catch((function(e){return console.log(e)}));var e})),s.formADD.addEventListener("submit",(function(e){e.preventDefault();var t=e.currentTarget.elements.name.value,n=e.currentTarget.elements.number.value,i={name:t,number:n};(a=i,d={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify(a)},fetch(o+"/contacts",d).then((function(e){return 400===e.status?void s.textError.classList.remove("is-hidden"):e.json()}))).then((function(e){var t=[];t.push(e),c(t),s.textError.classList.add("is-hidden")})).then((function(){i.name="",i.value="",s.formADD.reset(),s.textNoContacts.classList.add("is-hidden")})).catch((function(e){return console.log(e)}));var a,d})),s.listContacs.addEventListener("click",(function(e){var t=e.target.dataset,n=t.id,i=t.type;if("BUTTON"!==e.target.nodeName)return;n&&"delete"===i&&(a=r,c=n,fetch(o+"/contacts/"+c,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){return 401===e.status||404===e.status?void s.textError.classList.remove("is-hidden"):e.json()}))).then((function(){s.textError.classList.add("is-hidden"),d(r)})).catch((function(e){return console.log(e)}));var a,c;if(n&&"update"===i){var u=document.querySelector(".js-name-"+n),l=document.querySelector(".js-number-"+n),m={updateContact:u.textContent,number:l.textContent};s.contentForm.classList.add("is-hidden"),s.formUpdate.classList.remove("is-hidden"),s.formUpdate.elements.name.value=m.updateContact,s.formUpdate.elements.number.value=m.number,s.formUpdate.addEventListener("submit",(function(e){e.preventDefault(),function(e,t,n){var r={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(e)};return fetch(o+"/contacts/"+n,r).then((function(e){return 401===e.status||400===e.status?void s.textError.classList.remove("is-hidden"):e.json()}))}({name:e.target.elements.name.value,number:e.target.elements.number.value},r,n).then((function(){s.textError.classList.add("is-hidden"),s.formUpdate.classList.add("is-hidden"),s.formUpdate.reset(),s.contentForm.classList.remove("is-hidden"),d(r)})).catch((function(e){return console.log(e)}))}))}}))}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.26c0bc33cd03d181684e.js.map